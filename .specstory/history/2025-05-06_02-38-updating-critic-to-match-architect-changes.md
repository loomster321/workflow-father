<!-- Generated by SpecStory -->

# Updating Critic to Match Architect Changes (2025-05-05 19:38:54)

_**User**_

update the critic to reflect the many updates made to the architect.

---

_**Assistant**_

I'll update the ScriptStructureCritic.md file to reflect the updates made to the ScriptArchitecture.md file, focusing on aligning the critic's expectations with the architect's implementation.

---

Error calling tool 'edit_file'.

---

Let me break the edit into smaller parts:

---



---

Now I'll update the Duration and Word Count Calculation section:

---

```diff
    - `estimated_duration = word_count / 2.5`
    - This formula must be used for all segments with narration text (scenes, shots, beats).
+   - For parent segments (acts, sequences), the `estimated_duration` should be the sum of all child segment durations.
    - Use the Calculator Tool to verify this calculation for each relevant segment.
  - Ensure that no shot or beat exceeds recommended duration (2–5 seconds for B-roll) or word count (10–15 words). Flag and require subdivision if limits are exceeded.
```

---

Let me update the Evaluation Process section:

---

```diff
  2. **Validate Input Structure**
     - Ensure all required hierarchy levels and fields are present according to the schema
-    - Check for missing, empty, or placeholder fields
+    - Check for missing, empty, or placeholder fields with LOW_CONFIDENCE flags
+    - Verify the recursive structure for all levels, using the `segments` array for nesting
     - Log validation results and any detected issues.
  3. **Apply Evaluation Criteria**
```

---

Now, I'll update the Field-Level Validation Checklist:

---

```diff
  - [ ] IDs and labels unique and consistent
  - [ ] Each segment suitable for downstream production
+ - [ ] Ambiguous boundaries are properly documented and flagged
+ - [ ] Missing information is handled with appropriate LOW_CONFIDENCE placeholders
+ - [ ] Complex visualization requirements are broken down into appropriate shots and beats
  
  You are responsible for evaluating output against all field-level validation requirements as defined in the schema and workflow documentation.
```

---

I'll update the Error Handling and Edge Cases section:

---

```diff
  ## Error Handling and Edge Cases
  
- - If unable to identify a clear boundary at any level, require a LOW_CONFIDENCE flag and log the ambiguity.
- - If input is incomplete or ambiguous, require conservative segmentation and flag for review.
- - Never allow omission of required fields; require placeholders and log issues if necessary.
+ - If unable to identify a clear boundary at any level, check if the LOW_CONFIDENCE flag has been properly used and look for documentation in the description field.
+ - If input contains ambiguous boundaries, verify that the agent created separate segments when in doubt and documented the ambiguity.
+ - For missing information, ensure LOW_CONFIDENCE prefixes are used appropriately in the relevant fields.
+ - For overlapping content, check if any duplication is properly marked with "[DUPLICATED: reason]" in descriptions.
+ - For inconsistent narration flow, verify the use of semantic tags like `non_linear` or `parallel_action`.
+ - For complex visualization requirements, check if there is sufficient granularity with appropriate shots and beats.
  - If unable to parse input, log an error and halt processing with a clear message.
  
- Flag and log any issues or ambiguities using LOW_CONFIDENCE and logging.
+ Flag and provide specific feedback on any issues or ambiguities that weren't properly handled.
  
  ---
```

---

Now I'll update the Logging Tool Usage Example:

---



---

Finally, I'll update the Agent Boundaries and Best Practices section:

---

```diff
  - Do not modify the input; only evaluate and provide feedback.
  - Ensure all feedback is actionable and prioritized for revision.
+ - Pay special attention to error recovery mechanisms like LOW_CONFIDENCE flags and documentation in descriptions.
+ - Check for proper handling of ambiguous boundaries, missing information, and complex visualizations.
+ - Validate that parent segment durations properly reflect the sum of their child segments.
+ - When evaluating semantic tags, look for appropriate use of specialized tags for non-linear narratives, montages, and complex visualization requirements.
  - Maintain consistency with the workflow's terminology and schema.
  - Reference the evaluation criteria and scoring rubric for every review.
```

---

The ScriptStructureCritic.md file has been updated to align with the changes in the ScriptArchitecture.md file. Key updates include:

1. Aligned the schema validation to match the recursive structure described in the architect document
2. Updated duration calculation requirements to include both the formula and the parent-child relationship
3. Enhanced field-level validation to check for proper handling of ambiguities and complex visualizations
4. Updated error handling to validate proper use of LOW_CONFIDENCE flags and documentation
5. Ensured logging examples match the architect's implementation
6. Added validation for semantic tags related to non-linear narratives and complex visualizations
7. Expanded agent boundaries to include checking for proper duration aggregation in parent segments

These changes ensure the critic will properly evaluate scripts produced by the updated architecture agent, maintaining consistency across the workflow.

---

_**User**_

How many times can the critic reject the script structure, maximum?

---

_**Assistant**_

Based on the Script Architecture document, the maximum number of iterations in the self-critique loop between the Script Architecture Agent and the Script Structure Critic is 5.

This is defined in section "Step-by-Step Process" under point 5, "Iterative Self-Critique Loop":

> After generating the initial hierarchical structure, call the Critic Tool to evaluate the output.
> If the Critic Tool returns a "revise" or "fail" status, review the actionable feedback, revise the structure, and call the Critic Tool again.
> Repeat this process until the Critic Tool returns a "pass" status or a maximum number of iterations (e.g., 5) is reached.

So the Script Structure Critic can reject the script structure (with "revise" or "fail" status) a maximum of 5 times before the process must conclude, regardless of whether a "pass" status has been achieved.

---

